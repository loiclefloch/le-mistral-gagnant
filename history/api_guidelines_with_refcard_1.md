# Comprehensive Guidelines for RESTful API Design

## üìã Overview

This document provides comprehensive guidelines for designing RESTful APIs following industry best practices. These guidelines are based on REST principles (Roy Fielding), HTTP specifications, and the experience of major technology companies.

**Objective**: Create intuitive, consistent, secure, and developer-oriented APIs.

---

## üéØ Core Philosophy

### 1. Design Principles

#### Simplicity First (KISS - Keep It Simple, Stupid)
- The API should be usable **without having to consult the documentation**
- Self-descriptive and predictable
- Use standard and concrete terms, avoid business jargon

#### Client-Oriented
- Design for **application developers**, not for your data structure
- Prioritize main use cases before exceptions
- Think mobile-first (bandwidth optimization)

#### Absolute Consistency
- **One single way** to accomplish each task
- Uniform conventions across the entire API
- Predictable behaviors

#### WOA Architecture (Web Oriented Architecture)
- Pure REST architecture with HATEOAS
- Stateless microservices
- OAuth2 for authorization
- OpenID Connect for authentication
- HTTPS mandatory
- Asynchronous patterns for long-running operations

---

## üèóÔ∏è URL Structure

### Resource Naming Rules

#### ‚úÖ Use NOUNS, NOT verbs
REST is not SOAP-RPC. URLs represent resources, not actions.

```
‚úÖ CORRECT
GET /orders
GET /users
POST /products

‚ùå INCORRECT
GET /getAllOrders
POST /createUser
GET /fetchProducts
```

#### ‚úÖ Always use PLURAL
Consistency for both collections and individual instances.

```
‚úÖ CORRECT
GET /users          (collection)
GET /users/007      (instance)
POST /orders
DELETE /products/42

‚ùå INCORRECT
GET /user/007
GET /users/007/order/1234
```

#### ‚úÖ Use spinal-case (kebab-case)
Some servers ignore URL case sensitivity.

```
‚úÖ CORRECT
POST /specific-orders
GET /user-preferences
PUT /payment-methods/123

‚ùå INCORRECT
POST /specificOrders
GET /userPreferences
PUT /paymentMethods/123
```

#### ‚úÖ URL Hierarchy
Use hierarchy to express aggregation/composition relationships.

```
‚úÖ CORRECT
GET /orders/1234/products/1
GET /users/007/addresses/home
GET /companies/acme/employees/42

Meaning: products belong to orders
```

### Attribute Naming Convention

Choose **snake_case** OR **camelCase** and remain consistent throughout the entire API.

```json
// Option A: snake_case (recommended for JSON)
{
  "id_user": "007",
  "first_name": "James",
  "last_name": "Bond",
  "created_at": "2025-01-15T10:30:00+00:00"
}

// Option B: camelCase
{
  "idUser": "007",
  "firstName": "James",
  "lastName": "Bond",
  "createdAt": "2025-01-15T10:30:00+00:00"
}
```

**‚ö†Ô∏è Golden Rule**: Choose one style and NEVER deviate.

### Versioning

#### ‚úÖ Versioning MANDATORY in URL
- At the highest level of the URL
- Only major versions (v1, v2, v3)
- Support maximum **2 versions simultaneously**
- Consider native application update cycles

```
‚úÖ CORRECT
GET /v1/orders
POST /v2/users
GET /v1/products

‚ùå INCORRECT
GET /orders?version=1
GET /api/orders/v1
```

**Deprecation Strategy**:
1. Announce deprecation 6-12 months in advance
2. Include `Deprecation` and `Sunset` headers
3. Maintain v1 while v2 is being adopted
4. Remove v1 only when usage < 5%

---

## üîß HTTP Methods (CRUD Operations)

### Reference Table

| HTTP Method | Collection `/orders` | Instance `/orders/{id}` | Idempotent | Safe |
|-------------|---------------------|------------------------|------------|------|
| **GET** | List orders (200) | Retrieve ONE order (200) | ‚úÖ | ‚úÖ |
| **POST** | Create an order (201) | ‚ùå Error 405 | ‚ùå | ‚ùå |
| **PUT** | ‚ùå Error 405 | Replace completely (200) or Create with specific ID (201) | ‚úÖ | ‚ùå |
| **PATCH** | ‚ùå Error 405 | Partial update (200) | ‚ùå | ‚ùå |
| **DELETE** | ‚ùå Error 405 | Delete order (204) | ‚úÖ | ‚ùå |

### GET - Read Resources

**Usage**: Retrieve resources (collection or instance)

```http
# Collection
GET /v1/orders HTTP/1.1
Accept: application/json

‚Üí 200 OK
Content-Type: application/json
[
  {"id": "1234", "state": "paid", "total": 125.50},
  {"id": "5678", "state": "running", "total": 87.20}
]

# Instance
GET /v1/orders/1234 HTTP/1.1
Accept: application/json

‚Üí 200 OK
Content-Type: application/json
{
  "id": "1234",
  "state": "paid",
  "total": 125.50,
  "items": [...]
}
```

**Characteristics**:
- ‚úÖ Idempotent: multiple calls = same result
- ‚úÖ Safe: no data modification
- ‚úÖ Cacheable

### POST - Create Resource

**Usage**: Create a new resource when ID is generated by the server

```http
POST /v1/orders HTTP/1.1
Content-Type: application/json
Authorization: Bearer <token>

{
  "state": "running",
  "id_user": "007",
  "items": [
    {"product_id": "42", "quantity": 2}
  ]
}

‚Üí 201 Created
Location: https://api.example.com/v1/orders/1234
Content-Type: application/json
{
  "id": "1234",
  "state": "running",
  "id_user": "007",
  "created_at": "2025-01-15T10:30:00+00:00"
}
```

**Rules**:
- Return **201 Created** for success
- Include **Location** header with URI of the new resource
- Return created resource in body
- ‚ùå Non-idempotent: multiple POSTs = multiple resources

### PUT - Complete Replacement or Creation with Client ID

**Usage 1**: Completely replace an existing resource

```http
PUT /v1/orders/1234 HTTP/1.1
Content-Type: application/json

{
  "state": "paid",
  "id_user": "007",
  "total": 125.50
}

‚Üí 200 OK
```

**Usage 2**: Create a resource with a client-provided ID

```http
PUT /v1/orders/custom-id-abc HTTP/1.1
Content-Type: application/json

{
  "state": "running",
  "id_user": "007"
}

‚Üí 201 Created
Location: https://api.example.com/v1/orders/custom-id-abc
```

**Rules**:
- ‚úÖ Idempotent: multiple calls = same final result
- PUT replaces **ALL** attributes (not just those provided)
- If attribute omitted ‚Üí default value or null

### PATCH - Partial Update

**Usage**: Modify only certain attributes

```http
PATCH /v1/orders/1234 HTTP/1.1
Content-Type: application/json

{
  "state": "paid"
}

‚Üí 200 OK
Content-Type: application/json
{
  "id": "1234",
  "state": "paid",
  "id_user": "007",
  "total": 125.50
}
```

**Rules**:
- Modify **only** provided fields
- Other fields remain unchanged
- ‚ùå Generally non-idempotent (depends on implementation)
- Consider JSON Patch (RFC 6902) for complex operations

### DELETE - Delete Resource

**Usage**: Delete a resource

```http
DELETE /v1/orders/1234 HTTP/1.1

‚Üí 204 No Content
```

**Rules**:
- Return **204 No Content** (no body)
- ‚úÖ Idempotent: DELETE multiple times = same result
- If resource already absent ‚Üí 204 or 404 depending on philosophy

---

## üîç Query Parameters (Query String)

### Filtering

Use `?` to filter collection resources.

```http
GET /v1/orders?state=paid&id_user=007

‚Üí 200 OK
[
  {"id": "1234", "state": "paid", "id_user": "007"},
  {"id": "5678", "state": "paid", "id_user": "007"}
]
```

**Hierarchical alternative** (same resource, different URLs):
```http
GET /v1/users/007/orders?state=paid
```

### Sorting

**Format**: `?sort=attribute1,attribute2&desc=attribute1`

```http
# Ascending sort by rating, then reviews, then name
GET /v1/restaurants?sort=rating,reviews,name

# Descending sort
GET /v1/restaurants?sort=rating,name&desc=rating

# Combination
GET /v1/restaurants?sort=rating,reviews,name&desc=rating,reviews
```

**Rules**:
- Default: ascending order
- `sort`: list of attributes for ascending sort
- `desc`: list of attributes for descending sort
- Priority order: left to right

### Pagination (MANDATORY)

**‚ö†Ô∏è Critical Rule**: Every collection MUST have default pagination.

**Format**: `?range=start-end` (0-based indices)

```http
GET /v1/orders?range=0-24 HTTP/1.1

‚Üí 206 Partial Content
Content-Range: 0-24/971
Accept-Range: order 25
Link: <https://api.example.com/v1/orders?range=0-24>; rel="first",
      <https://api.example.com/v1/orders?range=25-49>; rel="next",
      <https://api.example.com/v1/orders?range=950-974>; rel="last"

[
  { "id": "1", ... },
  { "id": "2", ... },
  ...
]
```

**Required Headers**:
- `Content-Range`: `{start}-{end}/{total}`
- `Accept-Range`: `{unit} {default_page_size}`
- `Link`: Relations first, prev, next, last (RFC 5988)

**Status Codes**:
- **206 Partial Content**: pagination active
- **200 OK**: complete collection returned (rare)

**Recommended Configuration**:
- Default size: 25-50 items
- Maximum: 100-200 items
- Return 400 Bad Request if range invalid

### Partial Responses (Field Selection)

**Usage**: Allow client to select desired fields (crucial for mobile).

```http
GET /v1/users/007?fields=first_name,last_name,address(street,city)

‚Üí 200 OK
{
  "id": "007",
  "first_name": "James",
  "last_name": "Bond",
  "address": {
    "street": "Horsen Ferry Road",
    "city": "London"
  }
}
```

**Format**:
- Top-level fields: `field1,field2`
- Nested fields: `address(street,city)`
- Combination: `first_name,address(street,city(name)),orders(id,total)`

**Benefits**:
- Drastic bandwidth reduction
- Improved mobile-side performance
- Less client-side parsing

### Search

#### Resource-specific Search

```http
GET /v1/restaurants/search?type=thai&rating_min=4

‚Üí 200 OK
[...]
```

#### Global Search ("Google way")

```http
GET /v1/search?q=running+paid

‚Üí 200 OK
{
  "results": [
    {"type": "order", "id": "1234", ...},
    {"type": "user", "id": "007", ...}
  ]
}
```

### Reserved Keywords

These special endpoints should be implemented to facilitate usage.

#### `/first` - First element
```http
GET /v1/orders/first

‚Üí 200 OK
{"id": "1234", "state": "paid"}
```

#### `/last` - Last element
```http
GET /v1/orders/last

‚Üí 200 OK
{"id": "9999", "state": "running"}
```

#### `/count` - Number of elements
```http
GET /v1/orders/count

‚Üí 200 OK
{"count": 971}

# With filter
GET /v1/orders/count?state=paid

‚Üí 200 OK
{"count": 456}
```

---

## üìä HTTP Status Codes

### Success Codes (2xx)

| Code | Name | Usage |
|------|-----|-------|
| **200** | OK | General success (GET, PUT/PATCH update) |
| **201** | Created | Resource created (POST, PUT with new ID) |
| **202** | Accepted | Request accepted for asynchronous processing |
| **204** | No Content | Success with no content to return (DELETE) |
| **206** | Partial Content | Partial resource returned (pagination) |

### Client Error Codes (4xx)

#### 400 Bad Request - Invalid Request

```http
GET /v1/bookings?paid=true

‚Üí 400 Bad Request
Content-Type: application/json

{
  "error": "invalid_request",
  "error_description": "The property 'paid' does not exist. Did you mean 'state'?",
  "valid_properties": ["state", "id_user", "date"]
}
```

**When to use**:
- Invalid or missing parameters
- Malformed JSON
- Business validation failed
- Incorrect data type

#### 401 Unauthorized - Authentication Required

```http
GET /v1/orders

‚Üí 401 Unauthorized
WWW-Authenticate: Bearer realm="api"

{
  "error": "no_credentials",
  "error_description": "Authentication is required. Please provide a valid access token."
}
```

**When to use**:
- No token provided
- Expired token
- Invalid token

#### 403 Forbidden - Insufficient Permissions

```http
DELETE /v1/users/admin

‚Üí 403 Forbidden

{
  "error": "insufficient_permissions",
  "error_description": "You do not have permission to delete admin users.",
  "required_role": "super_admin"
}
```

**When to use**:
- Authenticated user but insufficient rights
- Action forbidden by business policy
- Protected resource

#### 404 Not Found - Resource Does Not Exist

```http
GET /v1/hotels/999999

‚Üí 404 Not Found

{
  "error": "not_found",
  "error_description": "The hotel with ID '999999' does not exist."
}
```

**When to use**:
- Requested resource does not exist
- Endpoint does not exist

#### 405 Method Not Allowed - Unsupported Method

```http
POST /v1/orders/1234

‚Üí 405 Method Not Allowed
Allow: GET, PUT, PATCH, DELETE

{
  "error": "method_not_allowed",
  "error_description": "POST is not supported on order instances. Use PUT to update or POST on /orders to create.",
  "allowed_methods": ["GET", "PUT", "PATCH", "DELETE"]
}
```

**When to use**:
- HTTP method not implemented for this resource
- Operation not permitted for this user

#### 406 Not Acceptable - Content Negotiation Failed

```http
GET /v1/hotels
Accept: application/xml
Accept-Language: zh

‚Üí 406 Not Acceptable

{
  "error": "not_acceptable",
  "error_description": "Cannot provide content in requested format and language.",
  "available_content_types": ["application/json"],
  "available_languages": ["en", "fr", "es"]
}
```

**When to use**:
- Requested format not available
- Requested language not supported

#### 409 Conflict - State Conflict

```http
DELETE /v1/orders/1234

‚Üí 409 Conflict

{
  "error": "conflict",
  "error_description": "Cannot delete order in 'paid' state. Cancel it first.",
  "current_state": "paid"
}
```

**When to use**:
- Conflict with current resource state
- Version conflict (optimistic locking)

#### 429 Too Many Requests - Rate Limiting

```http
GET /v1/orders

‚Üí 429 Too Many Requests
Retry-After: 60
X-RateLimit-Limit: 100
X-RateLimit-Remaining: 0
X-RateLimit-Reset: 1642248600

{
  "error": "rate_limit_exceeded",
  "error_description": "You have exceeded the rate limit of 100 requests per hour.",
  "retry_after": 60
}
```

### Server Error Codes (5xx)

#### 500 Internal Server Error

```http
‚Üí 500 Internal Server Error

{
  "error": "server_error",
  "error_description": "An unexpected error occurred. Our team has been notified.",
  "incident_id": "inc-2025-01-15-abc123"
}
```

**Rules**:
- NEVER expose technical details (stack trace, SQL)
- Log complete error server-side
- Provide incident ID for support

#### 503 Service Unavailable - Service Temporarily Unavailable

```http
‚Üí 503 Service Unavailable
Retry-After: 120

{
  "error": "service_unavailable",
  "error_description": "The service is temporarily unavailable due to maintenance.",
  "retry_after": 120
}
```

### Standardized Error Format

**All error codes (4xx, 5xx) must return structured JSON**:

```json
{
  "error": "error_code",
  "error_description": "Human-readable description in English",
  "error_description_i18n": "Translated description according to Accept-Language",
  "details": {
    "field": "value"
  },
  "documentation_url": "https://developers.example.com/errors/error_code",
  "request_id": "req-abc123"
}
```

---

## üîê Security

### HTTPS Mandatory

**‚ö†Ô∏è Absolute Rule**: Every API MUST use HTTPS for ALL requests.

```
‚úÖ CORRECT
https://api.example.com/v1/orders

‚ùå INCORRECT
http://api.example.com/v1/orders
```

**Configuration**:
- TLS 1.2 minimum (TLS 1.3 recommended)
- Valid certificates
- HSTS (HTTP Strict Transport Security) enabled
- Automatic HTTP ‚Üí HTTPS redirect

### OAuth 2.0 - Authorization

**Recommended standard** for 99% of use cases.

#### Authorization Flow

**Authorization Code Flow** (web/mobile applications):
```
1. Client ‚Üí Authorization Server: request code
2. User authentication + consent
3. Authorization Server ‚Üí Client: authorization code
4. Client ‚Üí Authorization Server: exchange code for access_token
5. Client ‚Üí API: requests with access_token
```

**Client Credentials Flow** (machine-to-machine):
```
1. Client ‚Üí Authorization Server: client_id + client_secret
2. Authorization Server ‚Üí Client: access_token
3. Client ‚Üí API: requests with access_token
```

#### Token Format

```http
GET /v1/orders HTTP/1.1
Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
```

**Rules**:
- `Bearer` prefix mandatory
- Token in `Authorization` header
- ‚ùå NEVER in URL or query string
- Limited lifetime (1h recommended)
- Refresh tokens for renewal

### OpenID Connect - Authentication

**Extension of OAuth 2.0** for user authentication.

**ID Token (JWT)**:
```json
{
  "iss": "https://oauth2.example.com",
  "sub": "007",
  "aud": "client_id_123",
  "exp": 1642248600,
  "iat": 1642245000,
  "name": "James Bond",
  "email": "james.bond@example.com"
}
```

### Rate Limiting

**Headers to include**:
```http
X-RateLimit-Limit: 100
X-RateLimit-Remaining: 75
X-RateLimit-Reset: 1642248600
```

**Recommended Strategy**:
- Per authenticated user: 1000 req/hour
- Per anonymous IP: 100 req/hour
- Sensitive endpoints: stricter limits

### Additional Best Practices

1. **CORS**: Configure properly for browser applications
2. **Input Validation**: Validate and sanitize all inputs
3. **SQL Injection**: Use parameterized queries
4. **XSS Protection**: Escape outputs
5. **CSRF Protection**: CSRF tokens for stateful APIs
6. **API Keys**: For client identification (not for user authentication)

---

## üåç Content Negotiation

### Content Format (Content Type)

**`Accept` Header**: Client specifies accepted formats.

```http
GET /v1/orders HTTP/1.1
Accept: application/json, text/plain;q=0.8

‚Üí 200 OK
Content-Type: application/json
```

**Supported Formats**:
- `application/json` (default, recommended)
- `application/xml` (optional)
- `text/csv` (for exports)

**Rules**:
- JSON by default if header absent
- Return 406 if format unavailable
- ‚ùå Avoid extensions in URL (`/orders.json`)

### Internationalization (i18n)

#### Dates and Times - ISO 8601

**Mandatory Format**: `YYYY-MM-DDThh:mm:ss¬±hh:mm`

```json
{
  "created_at": "2025-01-15T10:30:00+00:00",
  "updated_at": "2025-01-15T14:45:30+01:00",
  "birth_date": "1990-05-20"
}
```

**Accepted Formats**:
- Date + time + timezone: `2025-01-15T10:30:00+00:00`
- Date + time UTC: `2025-01-15T10:30:00Z`
- Date only: `2025-01-15`

#### Language - Accept-Language

```http
GET /v1/products HTTP/1.1
Accept-Language: fr-CA, fr-FR;q=0.9, en;q=0.8

‚Üí 200 OK
Content-Language: fr-CA
```

**Rules**:
- Use `Accept-Language` header
- ‚ùå Avoid query parameters (`?lang=fr`)
- Support minimum English (default language)
- Return `Content-Language` header

#### Currencies and Amounts

```json
{
  "total": 125.50,
  "currency": "EUR",
  "formatted_total": "125,50 ‚Ç¨"
}
```

**Format**:
- Amount as decimal number
- ISO 4217 currency code (3 letters)
- Optional formatted version according to locale

---

## üîó HATEOAS (Hypermedia as the Engine of Application State)

### Principle

The API should provide **hypermedia links** enabling complete API discovery.

### Link Header (RFC 5988)

```http
GET /v1/users/007 HTTP/1.1

‚Üí 200 OK
Link: <https://api.example.com/v1/users/007>; rel="self"; method="GET",
      <https://api.example.com/v1/users/007>; rel="update"; method="PUT",
      <https://api.example.com/v1/users/007>; rel="delete"; method="DELETE",
      <https://api.example.com/v1/users/007/orders>; rel="orders"; method="GET",
      <https://api.example.com/v1/users/007/addresses>; rel="addresses"; method="GET"

{
  "id": "007",
  "first_name": "James",
  "last_name": "Bond"
}
```

### Links in Body (HAL - Hypertext Application Language)

```json
{
  "id": "007",
  "first_name": "James",
  "last_name": "Bond",
  "_links": {
    "self": {
      "href": "https://api.example.com/v1/users/007"
    },
    "orders": {
      "href": "https://api.example.com/v1/users/007/orders"
    },
    "addresses": {
      "href": "https://api.example.com/v1/users/007/addresses"
    }
  }
}
```

### Standard Relations

| Relation | Meaning |
|----------|---------|
| `self` | The resource itself |
| `first` | First element of a collection |
| `last` | Last element of a collection |
| `next` | Next page |
| `prev` | Previous page |
| `edit` | Endpoint to modify |
| `delete` | Endpoint to delete |

**‚ö†Ô∏è Practical Reality**: Most developers will read documentation and copy/paste rather than follow links. Implement HATEOAS for discoverability, but maintain clear documentation.

---

## üåê CORS and Cross-Origin Compatibility

### CORS Standard

**Headers required for SPAs**:

```http
# Preflight Request (OPTIONS)
OPTIONS /v1/orders HTTP/1.1
Origin: https://app.example.com
Access-Control-Request-Method: POST
Access-Control-Request-Headers: Content-Type, Authorization

‚Üí 200 OK
Access-Control-Allow-Origin: https://app.example.com
Access-Control-Allow-Methods: GET, POST, PUT, PATCH, DELETE
Access-Control-Allow-Headers: Content-Type, Authorization
Access-Control-Max-Age: 86400

# Actual Request
POST /v1/orders HTTP/1.1
Origin: https://app.example.com

‚Üí 201 Created
Access-Control-Allow-Origin: https://app.example.com
```

**Recommended Configuration**:
- Whitelist of allowed origins
- Credentials allowed if necessary: `Access-Control-Allow-Credentials: true`
- Max-Age to cache preflight

### JSONP (Legacy Support)

**‚ö†Ô∏è Only for Internet Explorer 7/8/9**

```http
GET /v1/orders.jsonp?callback=handleOrders&access_token=...

‚Üí 200 OK
Content-Type: application/javascript

handleOrders([
  {"id": "1234", "state": "paid"},
  {"id": "5678", "state": "running"}
]);
```

**Critical Limitations**:
- ‚ùå Only GET (no POST/PUT/DELETE)
- ‚ùå No custom headers
- ‚ùå Security risk if poorly implemented
- ‚ùå Vulnerable to web crawlers

**If implemented**:
- Require `access_token` + `client_id`
- Validate callback name (alphanumeric only)
- Strict rate limiting

---

## üéØ Resource Granularity

### Medium Level (Recommended)

Avoid resources that are too fine-grained or too coarse-grained.

**‚úÖ CORRECT - Medium-grained**:
```json
GET /v1/users/007

{
  "id": "007",
  "first_name": "James",
  "last_name": "Bond",
  "email": "james.bond@example.com",
  "address": {
    "street": "Horsen Ferry Road",
    "city": {
      "name": "London",
      "country": "UK"
    }
  },
  "orders_count": 42
}
```

**‚ùå INCORRECT - Too fine-grained**:
```
GET /v1/users/007/first-name
GET /v1/users/007/last-name
GET /v1/users/007/address/street
GET /v1/users/007/address/city/name
```

**‚ùå INCORRECT - Too coarse-grained**:
```json
GET /v1/users/007

{
  "user": {...},
  "all_orders": [{...}, {...}, ...],
  "all_addresses": [{...}, {...}],
  "payment_methods": [{...}, {...}],
  "preferences": {...},
  "activity_log": [{...}, {...}, ...]
}
```

### 2-Level Maximum Rule

Limit resource nesting to **2 levels maximum** in URLs.

```
‚úÖ CORRECT
/orders/1234/products/5

‚ùå INCORRECT
/users/007/orders/1234/products/5/reviews/9
```

**Solution**: Use top-level resources:
```
GET /reviews/9
GET /products/5
```

---

## üöÄ Non-Resource Scenarios

### When to Use Verbs

In rare cases, the operation is not a resource but an **action** or **service**.

**Legitimate Examples**:

#### Email Sending
```http
POST /v1/emails/42/send

‚Üí 202 Accepted
{
  "status": "queued",
  "job_id": "job-abc123"
}
```

#### Calculator
```http
POST /v1/calculator/sum
Content-Type: application/json

[1, 2, 3, 5, 8, 13, 21]

‚Üí 200 OK
{
  "result": 53
}
```

#### Currency Conversion
```http
POST /v1/convert
Content-Type: application/json

{
  "from": "EUR",
  "to": "USD",
  "amount": 42
}

‚Üí 200 OK
{
  "from": "EUR",
  "to": "USD",
  "amount": 42,
  "result": 45.78,
  "rate": 1.09
}
```

**Or via query params for GET**:
```http
GET /v1/convert?from=EUR&to=USD&amount=42
```

### Golden Rule

**‚ö†Ô∏è Always seek RESTful modeling first.**

Example: instead of `POST /emails/42/send`, consider:
```http
# Model sending as a resource
POST /v1/email-sends
{
  "email_id": "42",
  "scheduled_at": "2025-01-15T14:00:00Z"
}
```

---

## üè¢ API Domain Structure

### Subdomain Organization

**Recommended configuration for production**:

| Subdomain | Usage | Example |
|-----------|-------|---------|
| `api.` | Production API | `https://api.company.com` |
| `api.sandbox.` | Test/Development API | `https://api.sandbox.company.com` |
| `developers.` | Developer Portal | `https://developers.company.com` |
| `oauth2.` | Production OAuth Server | `https://oauth2.company.com` |
| `oauth2.sandbox.` | Test OAuth Server | `https://oauth2.sandbox.company.com` |

### Benefits

- **Clear separation** between environments
- **Security**: data isolation
- **Flexibility**: independent deployment
- **Clarity**: developers know where to go

### Alternatives

**Path-based** (less recommended):
```
https://company.com/api/v1/
https://company.com/sandbox/api/v1/
```

---

## üìö Documentation

### cURL Examples

**Always provide** copy/pasteable cURL examples.

```bash
# Create an order
curl -X POST https://api.example.com/v1/orders \
  -H "Accept: application/json" \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer at-80003004-19a8-46a2-908e-33d4057128e7" \
  -d '{
    "id_user": "007",
    "state": "running",
    "items": [
      {"product_id": "42", "quantity": 2}
    ]
  }' \
  --client-id API_KEY_003

# Retrieve with pagination
curl -X GET "https://api.example.com/v1/orders?range=0-24&state=paid" \
  -H "Accept: application/json" \
  -H "Authorization: Bearer <your_token>"

# Partial update
curl -X PATCH https://api.example.com/v1/orders/1234 \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer <your_token>" \
  -d '{"state": "paid"}'

# Delete
curl -X DELETE https://api.example.com/v1/orders/1234 \
  -H "Authorization: Bearer <your_token>"
```

### OpenAPI Specification (Swagger)

**Use OpenAPI 3.x** to formally document the API.

```yaml
openapi: 3.0.0
info:
  title: Example API
  version: 1.0.0
  description: RESTful API following best practices

servers:
  - url: https://api.example.com/v1
    description: Production
  - url: https://api.sandbox.example.com/v1
    description: Sandbox

paths:
  /orders:
    get:
      summary: List all orders
      parameters:
        - name: range
          in: query
          schema:
            type: string
            default: "0-24"
        - name: state
          in: query
          schema:
            type: string
            enum: [running, paid, cancelled]
      responses:
        '206':
          description: Partial content
          headers:
            Content-Range:
              schema:
                type: string
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Order'
```

### Essential Documentation Elements

1. **Quickstart Guide**: Get a token and make the first call in 5 minutes
2. **Authentication**: How to obtain and use tokens
3. **Complete Examples**: For each endpoint, with request and response
4. **Error Codes**: Exhaustive list with examples
5. **Rate Limits**: Limits and headers
6. **Pagination**: How to navigate collections
7. **Webhooks**: If applicable
8. **SDKs**: Official libraries if available
9. **Changelog**: Version history
10. **Support**: How to get help

---

## ‚úÖ API Design Checklist

Before deploying your API, verify:

### URLs and Resources
- [ ] URLs use **nouns (not verbs)**
- [ ] Resources in **plural** everywhere
- [ ] **spinal-case** for multi-word URLs
- [ ] **snake_case** OR **camelCase** consistent for attributes
- [ ] **Versioning** in URL (`/v1/`)
- [ ] Maximum hierarchy of **2 levels**
- [ ] **Medium-grained** resources (neither too fine nor too coarse)

### HTTP Methods
- [ ] **GET** for reading (safe, idempotent, cacheable)
- [ ] **POST** for creation (non-idempotent)
- [ ] **PUT** for complete replacement (idempotent)
- [ ] **PATCH** for partial update
- [ ] **DELETE** for deletion (idempotent)
- [ ] No POST/PUT/DELETE on inappropriate collections

### Status Codes
- [ ] **200** for GET/PUT/PATCH success
- [ ] **201** for POST creation + `Location` header
- [ ] **204** for DELETE success
- [ ] **206** for pagination
- [ ] **400** for validation errors
- [ ] **401** for missing authentication
- [ ] **403** for insufficient permissions
- [ ] **404** for non-existent resource
- [ ] **500** for server errors (without technical details)

### Pagination
- [ ] **Mandatory** on all collections
- [ ] Format `?range=0-24`
- [ ] **Content-Range** header
- [ ] **Accept-Range** header
- [ ] **Link** header with first, next, prev, last
- [ ] Status **206 Partial Content**

### Filtering and Search
- [ ] Filtering via query params (`?state=paid`)
- [ ] Sorting via `?sort=` and `?desc=`
- [ ] Partial responses via `?fields=`
- [ ] `/search` endpoints for complex search
- [ ] `/count`, `/first`, `/last` endpoints for utility

### Security
- [ ] **HTTPS** mandatory everywhere
- [ ] **OAuth 2.0** for authorization
- [ ] **OpenID Connect** for authentication
- [ ] Tokens in **Authorization: Bearer** header
- [ ] **Rate limiting** implemented
- [ ] Rate limit headers exposed
- [ ] **CORS** properly configured
- [ ] Input validation and sanitization
- [ ] No sensitive data in URLs

### Content Negotiation
- [ ] **Accept** header for format (JSON by default)
- [ ] **Accept-Language** header for i18n
- [ ] Dates in **ISO 8601**
- [ ] Currencies in **ISO 4217**
- [ ] **Content-Type** header in responses

### Errors
- [ ] Standardized JSON format for all errors
- [ ] Fields `error` and `error_description`
- [ ] No exposed stack traces
- [ ] Clear and actionable error messages
- [ ] Server logging with incident IDs

### HATEOAS
- [ ] **Link** header with relations
- [ ] Links `self`, `next`, `prev` at minimum
- [ ] Documentation of available relations

### Documentation
- [ ] **OpenAPI 3.x** specification
- [ ] Copy/pasteable **cURL** examples
- [ ] Quick start guide
- [ ] Exhaustive list of error codes
- [ ] Request/response examples for each endpoint
- [ ] OAuth authentication documentation
- [ ] Version changelog

### Performance
- [ ] Partial responses available (`?fields=`)
- [ ] Pagination with reasonable default size
- [ ] Compression (gzip/brotli) enabled
- [ ] ETags for caching
- [ ] Appropriate cache headers

### Monitoring
- [ ] Structured logs (JSON)
- [ ] Metrics (latency, error rate, throughput)
- [ ] Alerts on 5xx errors
- [ ] Tracking of used versions
- [ ] Usage analytics

---

## üéì Advanced Principles

### Async Operations

For long-running operations, use the asynchronous pattern:

```http
# 1. Create the job
POST /v1/reports/generate

‚Üí 202 Accepted
Location: https://api.example.com/v1/jobs/abc123
{
  "job_id": "abc123",
  "status": "pending",
  "created_at": "2025-01-15T10:30:00Z"
}

# 2. Check status
GET /v1/jobs/abc123

‚Üí 200 OK
{
  "job_id": "abc123",
  "status": "processing",
  "progress": 45,
  "estimated_completion": "2025-01-15T10:32:00Z"
}

# 3. Retrieve result
GET /v1/jobs/abc123

‚Üí 200 OK
{
  "job_id": "abc123",
  "status": "completed",
  "result": {
    "report_url": "https://api.example.com/v1/reports/xyz789"
  }
}
```

### Webhooks

Allow clients to subscribe to events:

```http
# Webhook configuration
POST /v1/webhooks
{
  "url": "https://client.example.com/webhook",
  "events": ["order.created", "order.paid"],
  "secret": "whsec_abc123"
}

# Notification sent
POST https://client.example.com/webhook
X-Webhook-Signature: sha256=...
{
  "event": "order.created",
  "timestamp": "2025-01-15T10:30:00Z",
  "data": {
    "id": "1234",
    "state": "running"
  }
}
```

### GraphQL Consideration

**When to consider GraphQL instead of REST**:
- Need for very flexible queries
- Over-fetching/under-fetching problematic
- Complex relationships between entities
- Mobile client requiring extreme optimization

**But REST remains preferable for**:
- Simple public APIs
- Native HTTP caching important
- Less experienced team
- Maximum compatibility

### API Maturity Model (Richardson Maturity Model)

**Level 0**: Single endpoint, no HTTP verbs (SOAP-like)
**Level 1**: Multiple endpoints with resources
**Level 2**: HTTP verbs + appropriate status codes
**Level 3**: Complete HATEOAS

**Target**: Minimum level 2, level 3 if discoverability critical.

---

## üìñ References and Standards

### HTTP Specifications
- RFC 2616: HTTP/1.1
- RFC 7231: HTTP Semantics and Content
- RFC 7232: Conditional Requests
- RFC 7233: Range Requests
- RFC 7235: Authentication

### REST and Hypermedia
- Roy Fielding: REST Dissertation (2000)
- RFC 5988: Web Linking
- HAL (Hypertext Application Language)
- JSON-LD

### Security
- RFC 6749: OAuth 2.0
- RFC 6750: OAuth 2.0 Bearer Token
- RFC 7519: JSON Web Token (JWT)
- OpenID Connect Core 1.0

### Formats
- RFC 8259: JSON
- ISO 8601: Date and Time
- ISO 4217: Currency Codes
- RFC 5646: Language Tags

### Additional Resources
- Richardson Maturity Model
- Martin Fowler - REST
- API Design Patterns (Google, Microsoft, AWS)

---

## üéØ In Summary: The 10 Commandments of RESTful API

1. **HTTPS and OAuth2** you shall use, security you shall not neglect
2. **Plural nouns** for your resources you shall choose, verbs you shall ban
3. **Versioning** in the URL you shall place, two versions maximum you shall maintain
4. **HTTP verbs and status codes** correctly you shall employ, their semantics you shall respect
5. **Mandatory pagination** you shall implement, Link headers you shall not forget
6. **Structured errors** you shall return, technical details you shall hide
7. **Absolute consistency** you shall maintain, a single naming style you shall adopt
8. **Exhaustive documentation** you shall provide, cURL examples you shall include
9. **Medium-grained resources** you shall create, two levels maximum you shall nest
10. **For the developer** you shall design, user experience you shall prioritize

---

**Version**: 1.0
**Date**: 2025-11-13
**Author**: Based on OCTO Technology REST API Design Reference Card and industry best practices
**License**: Free use for internal and external projects

---

*This document should be used as a complete reference for all REST API design. It represents a balance between REST purism and development pragmatism. Adapt these guidelines according to your specific constraints, but remain consistent once choices are made.*

